<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NeonRadio</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background: black;
      color: white;
    }
    header {
      background: #111;
      padding: 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .burger, .close {
      cursor: pointer;
      font-size: 1.5rem;
    }
    .side {
      position: fixed;
      left: -300px;
      top: 0;
      width: 300px;
      height: 100vh;
      background: #222;
      transition: left 0.3s;
      padding: 1rem;
      overflow-y: auto;
    }
    .side.open {
      left: 0;
    }
    .station {
      background: #111;
      margin: 1rem;
      padding: 1rem;
      border-radius: 10px;
      position: relative;
    }
    .visualizer {
      display: flex;
      gap: 5px;
      height: 10px;
      margin: 10px 0;
    }
    .bar {
      flex: 1;
      background: linear-gradient(90deg, cyan, blue, cyan);
      animation: shift 2s linear infinite;
    }
    @keyframes shift {
      0% { background-position: 0 0; }
      100% { background-position: 200% 0; }
    }
    .switch {
      width: 50px;
      height: 25px;
      background: #444;
      border-radius: 25px;
      position: relative;
      cursor: pointer;
      margin-bottom: 1rem;
    }
    .switch::before {
      content: '';
      position: absolute;
      width: 23px;
      height: 23px;
      background: white;
      border-radius: 50%;
      top: 1px;
      left: 1px;
      transition: 0.3s;
    }
    .switch.active::before {
      left: 26px;
    }
    .star {
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 1.5rem;
      cursor: pointer;
    }
    .favorited {
      color: gold;
    }
    #favorites div {
      padding: 5px;
      border-bottom: 1px solid #333;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <header>
    NeonRadio
    <div class="burger" id="openMenu">☰</div>
  </header>
  <div class="side" id="menu">
    <div class="close" id="closeMenu">×</div>
    <h3>Голосовое управление</h3>
    <div class="switch active" id="voiceSwitch"></div>
    <p>Голос включён</p>
    <h3>Избранное</h3>
    <div id="favorites"></div>
  </div>

  <div class="station" data-url="http://radio.mediacdn.ru/radio/zvezda/zvezda_96">
    <h2>Радио Звезда</h2>
    <div class="star">☆</div>
    <div class="visualizer">
      <div class="bar"></div><div class="bar"></div><div class="bar"></div>
    </div>
    <button class="play">▶️ Play</button>
    <button class="pause" style="display:none;">⏸️ Pause</button>
  </div>

  <script>
    const openMenu = document.getElementById('openMenu');
    const closeMenu = document.getElementById('closeMenu');
    const menu = document.getElementById('menu');
    const voiceSwitch = document.getElementById('voiceSwitch');
    const favoritesContainer = document.getElementById('favorites');

    openMenu.onclick = () => menu.classList.add('open');
    closeMenu.onclick = () => menu.classList.remove('open');
    voiceSwitch.onclick = () => voiceSwitch.classList.toggle('active');

    let favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
    let audio = null;
    const station = document.querySelector('.station');
    const playBtn = station.querySelector('.play');
    const pauseBtn = station.querySelector('.pause');
    const star = station.querySelector('.star');
    const name = station.querySelector('h2').innerText;

    function updateFavorites() {
      favoritesContainer.innerHTML = '';
      favorites.forEach(title => {
        const div = document.createElement('div');
        div.textContent = title;
        div.onclick = () => {
          if (title === name) playBtn.click();
        };
        favoritesContainer.appendChild(div);
      });
    }

    if (favorites.includes(name)) {
      star.classList.add('favorited');
      star.textContent = '★';
    }

    star.onclick = () => {
      if (favorites.includes(name)) {
        favorites = favorites.filter(f => f !== name);
        star.classList.remove('favorited');
        star.textContent = '☆';
      } else {
        favorites.push(name);
        star.classList.add('favorited');
        star.textContent = '★';
      }
      localStorage.setItem('favorites', JSON.stringify(favorites));
      updateFavorites();
    };

    playBtn.onclick = () => {
      if (audio) audio.pause();
      audio = new Audio(station.dataset.url);
      audio.play();
      playBtn.style.display = 'none';
      pauseBtn.style.display = 'inline-block';
    };

    pauseBtn.onclick = () => {
      if (audio) audio.pause();
      playBtn.style.display = 'inline-block';
      pauseBtn.style.display = 'none';
    };

    updateFavorites();

    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    if (SpeechRecognition) {
      const recognition = new SpeechRecognition();
      recognition.lang = 'ru-RU';
      recognition.continuous = true;

      recognition.onresult = e => {
        const command = e.results[e.results.length - 1][0].transcript.toLowerCase();
        console.log('Голосовая команда:', command);
        if (command.includes(name.toLowerCase())) playBtn.click();
        if (command.includes('выключи')) pauseBtn.click();
        if (command.includes('громче') && audio) audio.volume = Math.min(audio.volume + 0.1, 1);
        if (command.includes('тише') && audio) audio.volume = Math.max(audio.volume - 0.1, 0);
      };

      recognition.start();
    }
  </script>
</body>
</html>
